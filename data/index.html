<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>TerraESP</title>
    <!-- <link rel="stylesheet" href="bootstrap.min.css"> -->
    <!-- <script src="bootstrap.min.js"></script> -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highcharts/5.0.6/highcharts.js"></script>

    <!-- Additional files for the Highslide popup effect -->
    <script type="text/javascript" src="http://www.highcharts.com/highslide/highslide-full.min.js"></script>
    <script type="text/javascript" src="http://www.highcharts.com/highslide/highslide.config.js" charset="utf-8"></script>
    <link rel="stylesheet" type="text/css" href="http://www.highcharts.com/highslide/highslide.css" />
    
    
    <!-- chart -->
    <script type="text/javascript">
    $(function () {
    var chart;
    $(document).ready(function() {
        // define the options
        var options = {
            chart: {
                renderTo: 'container',
                zoomType: 'x',
                type: 'spline'
            },
            title: {
                text: 'TerraESP'
            },
            subtitle: {
                text: 'Click and drag in the plot area to zoom in'
            },
            xAxis: {
                type: 'datetime',
            },
            yAxis: {
                title: {
                    text: 'C'
                },
                //startOnTick: false,
                //showFirstLabel: false
            },
            legend: {
                enabled: true
            },
            plotOptions: {
                series: {
                    cursor: 'pointer',
                    lineWidth: 1.0
                }
            },
            series: [{
                name: 'Temperature',
                color: '#ff0000',
                marker: {
                    radius: 2
                }
            },
            {
                name: 'Humid',
                color: '#0000ff',
                marker: {
                    radius: 2
                }
            }]
        };
    
    
        // Load data asynchronously using jQuery. On success, add the data
        // to the options and initiate the chart.
        // This data is obtained by exporting a GA custom report to TSV.
        // http://api.jquery.com/jQuery.get/
        jQuery.get("/sensordata.json", function(json) {
            console.log("got sensordata", json);
            // inconsistency
            //if (typeof json !== 'string') {
            //    json = xhr.responseText;
            //}
            //json = JSON.parse(json);
            // convert seconds to milliseconds
            for(var i=0; i<json["temperature"].length; i++){
                json["temperature"][i][0] *= 1000;
                json["humid"][i][0] *= 1000;
            }
            options.series[0].data = json["temperature"];
            options.series[1].data = json["humid"];
            chart = new Highcharts.Chart(options);
        });
    });
    });
    </script>    
</head>
<body>

<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <a class="navbar-brand" href="#">TerraESP</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/config">Config</a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container">

      <div class="starter-template">
        <h1>Bootstrap starter template</h1>
        <p class="lead">Use this document as a way to quickly start any new project.<br> All you get is this text and a mostly barebones HTML document.</p>
        <div id="buttons">
            %BUTTONS%
        </div>
        <div id="graphs">
            %GRAPHS%
            <div id="container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
        </div>
      </div>

    </div>
</body>
</html>
